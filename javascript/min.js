function getNavbar(){var a="";switch(user.role){case"professor":a='<ul><li><a class="strong" href="first.html">Classes</a></li><li><a href="" onclick="loadExams()">Exam dates</a></li></ul>';break;case"referat":a='<ul><li><a href="" onclick="loadStudents()">Students</a></li><li><a href="" onclick="loadProfessors()">Professors</a></li><li><a href="" onclick="loadClasses(\''+user.role+'\')">Classes</a></li><li><a href="" onclick="loadRequests(\''+user.role+'\')">Requests</a></li><li><a href="" onclick="loadOrders(\''+user.role+"')\">Orders</a></li></ul>";break;default:a='<ul><li><a class="strong" href="first.html">Classes</a></li><li><a href="student/dates.html")">Exam dates</a></li><li><a href="student/requests.html">Requests</a></li><li><a href="student/index.html">Index</a></li><li><a href="student/orders.html">Orders</a></li></ul>'}return a}function getOptions(a){for(var b="<option></option>",c=0;c<users.length;c++)users[c].role===a&&(b+='<option value="'+users[c].id+'">'+users[c].name+"</option>");return b}function updateOptions(a){if("professor"===a.role){var b=document.forms.addClass.classProfessor;b.innerHTML+='<option value="'+a.id+'">'+a.name+"</option>"}}function getClasses(){var a="";if(user.classes)for(var b=0;b<user.classes.length;b++)for(var c=0;c<classes.length;c++)if(user.classes[b].id===classes[c].id)if("professor"===user.role){a+='<div class="professor">',a+='<table class="fullWidth">',a+="<tr>",a+='<td width="80%"><h4>'+classes[c].name+"</h4></td>",a+='<td width="10%"><p>'+classes[c].enrolled.length+"</p></td>",a+='<td width="10%">';for(var d=0;d<classes[c].exams.length;d++)a+="<small>&emsp;"+classes[c].exams[d]+"</small><br />";a+="</td>",a+="</tr>",a+="</table>",a+="</div>"}else{var e=user.classes[b].mark?user.classes[b].mark:"";a+='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<td width="80%"><h4>'+classes[c].name+"</h4>",a+="<small><u>Exam dates:</u></small><br />";for(var d=0;d<classes[c].exams.length;d++)a+="<small>&emsp;"+classes[c].exams[d]+"</small><br />";a+="</td>",a+='<td width="10%"><p>'+e+"</p></td>",a+="</td>",a+="</tr>",a+="</table>",a+="</div>"}return a}function getFirst(){var a="";switch(user.role){case"referat":a='<div class="referat">',a+="<h3>Add student</h3>",a+='<form name="addStudent">',a+="<label>",a+="First name: ",a+='<input name="firstName" type="text" placeholder="First name" required/>',a+='</label><div class="spacer"></div>',a+="<label>",a+="Last Name: ",a+='<input name="lastName" type="text" placeholder="Last name" required/>',a+='</label><div class="spacer"></div>',a+='<a id="submit" class="submit" onclick="add(\'student\')">Add</a>',a+="</form>",a+="</div>",a+='<div class="referat">',a+="<h3>Add professor</h3>",a+='<form name="addProfessor">',a+="<label>",a+="First name: ",a+='<input name="firstName" type="text" placeholder="First name" required/>',a+='</label><div class="spacer"></div>',a+="<label>",a+="Last Name: ",a+='<input name="lastName" type="text" placeholder="Last name" required/>',a+='</label><div class="spacer"></div>',a+='<a id="submit" class="submit" onclick="add(\'professor\')">Add</a>',a+="</form>",a+="</div>",a+='<div class="referat">',a+="<h3>Add class</h3>",a+='<form name="addClass">',a+="<label>",a+="Class name: ",a+='<input name="className" type="text" placeholder="Class name" required/>',a+='</label><div class="spacer"></div>',a+="<label>",a+="Professor: ",a+='<select name="classProfessor">',a+=getOptions("professor"),a+="</select>",a+='</label><div class="spacer"></div>',a+='<a id="submit" class="submit" onclick="add(\'class\')">Add</a>',a+="</form>",a+="</div>";break;case"professor":a='<div class="professor">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="80%">Class name</th>',a+='<th width="10%">Students</th>',a+='<th width="10%">Exam dates</th>',a+="</tr>",a+="</table>",a+="</div>",a+=getClasses();break;default:a='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="90%">Class name</th>',a+='<th width="10%">Mark</th>',a+="</tr>",a+="</table>",a+="</div>",a+=getClasses()}return a}function getStudentRequests(){var a;a='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="20%">Request name</th>',a+='<th width="80%">Request description</th>',a+="</tr>",a+="</table>",a+="</div>";for(var b=0;b<requests.length;b++)a+='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="20%"><a href="request.html" onclick="loadStudentRequest('+requests[b].id+')">'+requests[b].name+"</a></th>",a+='<td width="80%">'+requests[b].shortDescription+"</td>",a+="</tr>",a+="</table>",a+="</div>";return a}function loadRequest(){for(var a,b=parseInt(window.localStorage.getItem("request")),c=0;c<requests.length;c++)if(requests[c].id===b){a="<h2>"+requests[c].name+"</h2>",a+="<p>"+requests[c].description+"</p>",a+='<form name="requestForm">',a+='<label>Additional comments:<br /><textarea name="comments"  placeholder="Write possible additional comment here..."></textarea></label>',a+='<label>Add files: <small>You can add up to 2 files</small> <br /><input type="file" name="files" multiple="true" onchange="checkFiles();"></input></label>',a+='<a id="submit" class="submit" onclick="submit()">Submit</a>',a+="</form>";break}return a}var user,getData=function(a){switch(user=JSON.parse(localStorage.getItem("user")),document.getElementById("person").innerHTML="<p>Hello "+user.name+"</p>",a){case"first":document.getElementById("general").innerHTML=getFirst(),document.getElementById("navbar").innerHTML=getNavbar();break;case"requests":switch(user.role){case"student":document.getElementById("general").innerHTML=getStudentRequests();break;default:document.getElementById("general").innerHTML=getStudentRequests()}break;case"request":document.getElementById("general").innerHTML=loadRequest();break;default:document.getElementById("general").innerHTML=getFirst(),document.getElementById("navbar").innerHTML=getNavbar()}},add=function(a){var b,c;switch(a){case"professor":b=document.forms.addProfessor.firstName.value,c=document.forms.addProfessor.lastName.value;var d=users.length+1;users.push({id:d,name:b+" "+c,username:b.toLowerCase()+c.toLowerCase().substring(0,1),password:c.toLowerCase()+"4321",role:a,holding:[]}),updateOptions({name:b+" "+c,id:d,role:a}),document.forms.addProfessor.lastName.value="",document.forms.addProfessor.firstName.value="";break;case"student":b=document.forms.addStudent.firstName.value,c=document.forms.addStudent.lastName.value,users.push({id:users.length+1,name:b+" "+c,username:b.toLowerCase()+c.toLowerCase().substring(0,1),password:b.toLowerCase()+"1234",role:a,enrolled:[],requests:[],orders:[]}),document.forms.addStudent.lastName.value="",document.forms.addStudent.firstName.value="";break;case"class":b=document.forms.addClass.className.value,c=document.forms.addClass.classProfessor.value;var e=classes.length+1;if(classes.push({id:e,name:b,exams:[],enrolled:[]}),c)for(var f=0;f<users.length;f++)if(users[f].id.toString()===c){users[f].holding.push({id:e});break}document.forms.addClass.className.value="",document.forms.addClass.classProfessor.value="";break;default:console.error("Unrecognized add")}},loadStudentRequest=function(a){window.localStorage.setItem("request",a)},checkFiles=function(){document.forms.requestForm.files.files.length>2&&(alert("Too many files. Please reupload."),document.forms.requestForm.files.value="")},submit=function(){var a=parseInt(window.localStorage.getItem("request")),b=document.forms.requestForm.comments.value,c=document.forms.requestForm.files.files;studentRequests.push({idRequest:a,idStudent:user.id,comments:b,files:c.length?c:void 0}),window.localStorage.removeItem("request"),window.location.href="requests.html"},logout=function(){window.localStorage.removeItem("user");var a=new RegExp(/e-Student\/\S+\/\S+\.html/);a.test(window.location.href)?window.location.href="../index.html":window.location.href="index.html"},login=function(){for(var a=document.forms.loginForm.username.value,b=document.forms.loginForm.password.value,c=document.getElementById("submit"),d=document.getElementsByClassName("error"),e=!1,f=0;f<users.length;f++)a===users[f].username&&(e=!0,b===users[f].password?(c.href="first.html",localStorage.setItem("user",JSON.stringify({id:users[f].id,name:users[f].name,role:users[f].role,classes:users[f].enrolled?users[f].enrolled:users[f].holding}))):d[0].innerHTML="<p>You entered wrong password</p>");return e||(d[0].innerHTML="<p>You entered wrong username</p>"),!1},users=[{id:1,username:"adrianj",name:"Adrian Jarc",password:"adrian1234",role:"student",enrolled:[{id:1,mark:6},{id:2}],requests:[],orders:[]},{id:2,username:"janezn",name:"Janez Novak",password:"novak4321",role:"professor",holding:[{id:1},{id:2}]},{id:3,username:"metak",name:"Meta Kri≈æman",password:"metkriz12",role:"referat"}],classes=[{id:1,name:"Spletno programiranje",exams:["12.2.2017 10.00","26.2.2017 10.00"],enrolled:[{id:1}]},{id:2,name:"Something",exams:["14.2.2017 10.00"],enrolled:[{id:1}]}],requests=[{id:1,name:"Somthing",shortDescription:"Somthing",description:"Something longer"}],studentRequests=[],orders=[];
