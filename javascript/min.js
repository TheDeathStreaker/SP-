function getNavbar(){var a="";switch(user.role){case"professor":a='<ul><li><a class="strong" href="first.html">Classes</a></li><li><a href="professor/dates.html">Exam dates</a></li></ul>';break;case"referat":a='<ul><li><a href="referat/students.html">Students</a></li><li><a href="referat/professors.html">Professors</a></li><li><a href="referat/classes.html">Classes</a></li><li><a href="referat/requests.html">Requests</a></li><li><a href="referat/orders.html">Orders</a></li></ul>';break;default:a='<ul><li><a class="strong" href="first.html">Classes</a></li><li><a href="student/dates.html")">Exam dates</a></li><li><a href="student/requests.html">Requests</a></li><li><a href="student/index.html">Index</a></li><li><a href="student/orders.html">Orders</a></li></ul>'}return a}function getOptions(a){for(var b="<option></option>",c=0;c<users.length;c++)users[c].role===a&&(b+='<option value="'+users[c].id+'">'+users[c].name+"</option>");return b}function updateOptions(a){if("professor"===a.role){var b=document.forms.addClass.classProfessor;b.innerHTML+='<option value="'+a.id+'">'+a.name+"</option>"}}function getClasses(){var a="";if(user.classes)for(var b=0;b<user.classes.length;b++)for(var c=0;c<classes.length;c++)if(user.classes[b].id===classes[c].id)if("professor"===user.role){a+='<div class="professor">',a+='<table class="fullWidth">',a+="<tr>",a+='<td width="80%"><h4>'+classes[c].name+"</h4></td>",a+='<td width="10%"><p>'+classes[c].enrolled.length+"</p></td>",a+='<td width="10%">';for(var d=0;d<classes[c].exams.length;d++)a+="<small>&emsp;"+classes[c].exams[d]+"</small><br />";a+="</td>",a+="</tr>",a+="</table>",a+="</div>"}else{var e=user.classes[b].mark?user.classes[b].mark:"";a+='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<td width="80%"><h4>'+classes[c].name+"</h4>",a+="<small><u>Exam dates:</u></small><br />";for(var d=0;d<classes[c].exams.length;d++)a+="<small>&emsp;"+classes[c].exams[d]+"</small><br />";a+="</td>",a+='<td width="10%"><p>'+e+"</p></td>",a+="</td>",a+="</tr>",a+="</table>",a+="</div>"}return a}function getFirst(){var a="";switch(user.role){case"referat":a='<div class="referat">',a+="<h3>Add person</h3>",a+='<form name="addPerson">',a+="<label>",a+="First name: ",a+='<input name="firstName" type="text" placeholder="First name" required/>',a+='</label><div class="spacer"></div>',a+="<label>",a+="Last Name: ",a+='<input name="lastName" type="text" placeholder="Last name" required/>',a+='</label><div class="spacer"></div>',a+="<label>",a+="Role: ",a+='<select name="role">',a+='<option value="student">Student</option>',a+='<option value="professor">Professor</option>',a+='<option value="referat">Referat</option>',a+="</select>",a+='</label><div class="spacer"></div>',a+='<a id="submit" class="submit" onclick="add()">Add</a>',a+="</form>",a+="</div>",a+='<div class="referat">',a+="<h3>Add class</h3>",a+='<form name="addClass">',a+="<label>",a+="Class name: ",a+='<input name="className" type="text" placeholder="Class name" required/>',a+='</label><div class="spacer"></div>',a+="<label>",a+="Professor: ",a+='<select name="classProfessor">',a+=getOptions("professor"),a+="</select>",a+='</label><div class="spacer"></div>',a+='<a id="submit" class="submit" onclick="add(\'class\')">Add</a>',a+="</form>",a+="</div>";break;case"professor":a='<div class="professor">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="80%">Class name</th>',a+='<th width="10%">Students</th>',a+='<th width="10%">Exam dates</th>',a+="</tr>",a+="</table>",a+="</div>",a+=getClasses();break;default:a='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="90%">Class name</th>',a+='<th width="10%">Mark</th>',a+="</tr>",a+="</table>",a+="</div>",a+=getClasses()}return a}function getStudentRequests(){var a;a='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="20%">Request name</th>',a+='<th width="80%">Request description</th>',a+="</tr>",a+="</table>",a+="</div>";for(var b=0;b<requests.length;b++)a+='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="20%"><a href="request.html" onclick="loadStudentRequest('+requests[b].id+')">'+requests[b].name+"</a></th>",a+='<td width="80%">'+requests[b].shortDescription+"</td>",a+="</tr>",a+="</table>",a+="</div>";return a}function loadRequest(){for(var a,b=parseInt(window.localStorage.getItem("request")),c=0;c<requests.length;c++)if(requests[c].id===b){a="<h2>"+requests[c].name+"</h2>",a+="<p>"+requests[c].description+"</p>",a+='<form name="requestForm">',a+='<label>Additional comments:<br /><textarea name="comments"  placeholder="Write possible additional comment here..."></textarea></label>',a+='<label>Add files: <small>You can add up to 2 files</small> <br /><input type="file" name="files" multiple="true" onchange="checkFiles();"></input></label>',a+='<a id="submit" class="submit" onclick="submit()">Submit</a>',a+="</form>";break}return a}function loadOrders(){var a;return a='<div class="student">',a+="<h4>Physical copy of index</h4>",a+='<form name="indexForm">',a+='<input type="radio" name="language" value="en" checked />English <input type="radio" name="language" value="sl" />Slovene<br />',a+='<a id="submit" class="submit" onclick="order(\'index\')">Order</a>',a+="</form>",a+="</div>",a+='<div class="student">',a+="<h4>Confirmation of signing in</h4>",a+='<form name="confirmationForm">',a+='<label>Amount:<br /><input type="number" name="amount" value="2" min="1" max="10" /></label>',a+='<a id="submit" class="submit" onclick="order(\'confirmation\')">Order</a>',a+="</form>",a+="</div>"}function loadIndex(){var a;a='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="80%">Class name</th>',a+='<th width="20%">Mark</th>',a+="</tr>",a+="</table>",a+="</div>";for(var b=0;b<user.classes.length;b++)for(var c=0;c<classes.length;c++)user.classes[b].id===classes[c].id&&user.classes[b].mark&&(a+='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<td width="80%"><h4>'+classes[c].name+"</h4>",a+="</td>",a+='<td width="20%"><p>'+user.classes[b].mark+"</p></td>",a+="</td>",a+="</tr>",a+="</table>",a+="</div>");return a}function loadDates(){var a;a='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="80%">Class name</th>',a+='<th width="20%">Dates</th>',a+="</tr>",a+="</table>",a+="</div>";for(var b=0;b<user.classes.length;b++)for(var c=0;c<classes.length;c++)if(user.classes[b].id===classes[c].id&&!user.classes[b].mark){a+='<div class="student">',a+='<table class="fullWidth">',a+="<tr>",a+='<td width="80%"><h4>'+classes[c].name+"</h4>",a+="</td>",a+='<td width="20%">';for(var d=0;d<classes[c].exams.length;d++)a+="<p>"+classes[c].exams[d]+"</p>";a+="</td>",a+="</td>",a+="</tr>",a+="</table>",a+="</div>"}return a}function loadProfDates(){var a;a='<div class="professor">',a+='<table class="fullWidth">',a+="<tr>",a+='<th width="80%">Class name</th>',a+='<th width="20%">Exam dates</th>',a+="</tr>",a+="</table>",a+="</div>";for(var b=0;b<user.classes.length;b++)for(var c=0;c<classes.length;c++)if(user.classes[b].id===classes[c].id){a+='<div class="professor">',a+='<table class="fullWidth">',a+="<tr>",a+='<td width="80%"><h4>'+classes[c].name+"</h4></td>",a+='<td width="20%">';for(var d=0;d<classes[c].exams.length;d++)a+="<p>"+classes[c].exams[d]+"</p>";a+="</td>",a+="</tr>",a+="</table>",a+="</div>"}return a}var user,getData=function(a){switch(user=JSON.parse(localStorage.getItem("user")),document.getElementById("dropdownmenu").innerHTML="Hello "+user.name,a){case"first":document.getElementById("general").innerHTML=getFirst(),document.getElementById("navbar").innerHTML=getNavbar();break;case"requests":switch(user.role){case"student":document.getElementById("general").innerHTML=getStudentRequests();break;default:document.getElementById("general").innerHTML=getRefRequests()}break;case"request":document.getElementById("general").innerHTML=loadRequest();break;case"dates":switch(user.role){case"student":document.getElementById("general").innerHTML=loadDates();break;default:document.getElementById("general").innerHTML=loadProfDates()}break;case"change":document.getElementById("navbar").innerHTML=getNavbar();break;case"orders":switch(user.role){case"student":document.getElementById("general").innerHTML=loadOrders();break;default:document.getElementById("general").innerHTML=loadOrdersReferat()}break;case"index":document.getElementById("general").innerHTML=loadIndex();break;default:document.getElementById("general").innerHTML=getFirst(),document.getElementById("navbar").innerHTML=getNavbar()}},add=function(a){var b,c,d;if(void 0===a)var b=document.forms.addPerson.firstName.value,c=document.forms.addPerson.lastName.value,d=document.forms.addPerson.role.value;else d=a;switch(d){case"professor":var e=users.length+1;users.push({id:e,name:b+" "+c,username:b.toLowerCase()+c.toLowerCase().substring(0,1),password:c.toLowerCase()+"4321",role:d,holding:[]}),updateOptions({name:b+" "+c,id:e,role:d}),document.forms.addPerson.firstName.value="",document.forms.addPerson.lastName.value="";break;case"student":users.push({id:users.length+1,name:b+" "+c,username:b.toLowerCase()+c.toLowerCase().substring(0,1),password:b.toLowerCase()+"1234",role:d,enrolled:[],requests:[],orders:[]}),document.forms.addPerson.firstName.value="",document.forms.addPerson.lastName.value="";break;case"referat":users.push({id:users.length+1,name:b+" "+c,username:b.toLowerCase()+c.toLowerCase().substring(0,1),password:b.toLowerCase().substring(0,3)+c.toLowerCase().substring(0,4)+"12",role:d}),document.forms.addPerson.firstName.value="",document.forms.addPerson.lastName.value="";break;case"class":b=document.forms.addClass.className.value,c=document.forms.addClass.classProfessor.value;var f=classes.length+1;if(classes.push({id:f,name:b,exams:[],enrolled:[]}),c)for(var g=0;g<users.length;g++)if(users[g].id.toString()===c){users[g].holding.push({id:f});break}document.forms.addClass.className.value="",document.forms.addClass.classProfessor.value="";break;default:console.error("Unrecognized add")}},loadStudentRequest=function(a){window.localStorage.setItem("request",a)},checkFiles=function(){document.forms.requestForm.files.files.length>2&&(alert("Too many files. Please reupload."),document.forms.requestForm.files.value="")},submit=function(){var a=parseInt(window.localStorage.getItem("request")),b=document.forms.requestForm.comments.value,c=document.forms.requestForm.files.files;studentRequests.push({idRequest:a,idStudent:user.id,comments:b,files:c.length?c:void 0}),window.localStorage.removeItem("request"),window.location.href="requests.html"},logout=function(){if(window.localStorage.removeItem("user"),"file:"===window.location.protocol){var a=new RegExp(/e-Student\/\S+\/\S+\.html/);a.test(window.location.href)?window.location.href="../index.html":window.location.href="index.html"}else window.location.href="/"},changePwd=function(){var a=document.forms.changePass.password1.value,b=document.forms.changePass.password2.value,c=document.getElementsByClassName("error");if(a===b){for(var d=0;d<users.length;d++)if(user.id===users[d].id){users[d].password=a,c[0].innerHTML="<p>Password changed successfully.</p>";break}}else c[0].innerHTML="<p>Passwords do not match.</p>";a=document.forms.changePass.password1.value="",a=document.forms.changePass.password2.value=""},order=function(a){switch(a){case"index":var b=document.forms.indexForm.language.value;orders.push({type:a,language:b,student:user.id});break;default:var c=document.forms.confirmationForm.amount.value;orders.push({type:a,amount:parseInt(c),student:user.id})}},login=function(){for(var a=document.forms.loginForm.username.value,b=document.forms.loginForm.password.value,c=document.getElementById("submit"),d=document.getElementsByClassName("error"),e=!1,f=0;f<users.length;f++)a===users[f].username&&(e=!0,b===users[f].password?(c.href="first.html",localStorage.setItem("user",JSON.stringify({id:users[f].id,name:users[f].name,role:users[f].role,classes:users[f].enrolled?users[f].enrolled:users[f].holding}))):d[0].innerHTML="<p>You entered wrong password</p>");return e||(d[0].innerHTML="<p>You entered wrong username</p>"),!1},users=[{id:1,username:"adrianj",name:"Adrian Jarc",password:"adrian1234",role:"student",enrolled:[{id:1,mark:6},{id:2}],requests:[],orders:[]},{id:2,username:"janezn",name:"Janez Novak",password:"novak4321",role:"professor",holding:[{id:1},{id:2}]},{id:3,username:"metak",name:"Meta Križman",password:"metkriz12",role:"referat"}],classes=[{id:1,name:"Spletno programiranje",exams:["12.2.2017 10.00","26.2.2017 10.00"],enrolled:[{id:1}]},{id:2,name:"Something",exams:["14.2.2017 10.00"],enrolled:[{id:1}]}],requests=[{id:1,name:"Somthing",shortDescription:"Somthing",description:"Something longer"}],studentRequests=[],orders=[];